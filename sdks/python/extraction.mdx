---
title: "Data Extraction"
description: "Extract structured data from documents using JSON schemas with the Unsiloed Python SDK"
---

# Data Extraction

The Extract API allows you to extract specific data from documents using JSON schemas. Define exactly what data you need, and Unsiloed will extract it with confidence scores and optional citations.

## Basic Usage

### Synchronous

```python
from unsiloed_sdk import UnsiloedClient

schema = {
    "type": "object",
    "properties": {
        "invoice_number": {
            "type": "string",
            "description": "Invoice number from the document"
        },
        "total_amount": {
            "type": "number",
            "description": "Total amount on the invoice"
        }
    },
    "required": ["invoice_number", "total_amount"],
    "additionalProperties": False
}

with UnsiloedClient(api_key="your-api-key") as client:
    result = client.extract_and_wait(
        file="invoice.pdf",
        schema=schema
    )

    # Access extracted data with confidence scores
    print(f"Invoice #: {result.result['invoice_number']['value']}")
    print(f"Confidence: {result.result['invoice_number']['score']:.2%}")
    print(f"Total: ${result.result['total_amount']['value']}")
```

### Async

```python
import asyncio
from unsiloed_sdk import AsyncUnsiloedClient

async def main():
    schema = {
        "type": "object",
        "properties": {
            "company_name": {"type": "string"},
            "date": {"type": "string"},
            "amount": {"type": "number"}
        },
        "required": ["company_name", "date", "amount"],
        "additionalProperties": False
    }

    async with AsyncUnsiloedClient(api_key="your-api-key") as client:
        result = await client.extract_and_wait(
            file="document.pdf",
            schema=schema
        )

        for field, data in result.result.items():
            print(f"{field}: {data['value']} (confidence: {data['score']:.2%})")

asyncio.run(main())
```

## Extract Methods

### 1. extract_and_wait() - Automatic Polling (Recommended)

```python
result = client.extract_and_wait(
    file="invoice.pdf",
    schema=schema,
    poll_interval=2.0,  # Check status every 2 seconds
    max_wait=600.0      # Maximum wait time
)
```

### 2. extract() - Start Job

```python
response = client.extract(
    file="invoice.pdf",
    schema=schema,
    confidence_threshold=0.9
)

print(f"Job ID: {response.job_id}")
```

### 3. get_extract_result() - Check Status

```python
result = client.get_extract_result(job_id="your-job-id")

if result.status == "completed":
    print(f"Extraction complete!")
    print(result.result)
elif result.status == "failed":
    print(f"Failed: {result.error}")
```

## Schema Definition

### Basic Schema Structure

A JSON schema defines the structure of data to extract:

```python
schema = {
    "type": "object",
    "properties": {
        "field_name": {
            "type": "string",  # or "number", "boolean", "array", "object"
            "description": "What to extract and where to find it"
        }
    },
    "required": ["field_name"],  # Optional: fields that must be present
    "additionalProperties": False  # Optional: reject extra fields
}
```

### Data Types

#### String Fields

```python
{
    "invoice_number": {
        "type": "string",
        "description": "Invoice number or ID"
    },
    "date": {
        "type": "string",
        "description": "Invoice date in any format"
    }
}
```

#### Number Fields

```python
{
    "total": {
        "type": "number",
        "description": "Total amount"
    },
    "quantity": {
        "type": "number",
        "description": "Number of items"
    }
}
```

#### Boolean Fields

```python
{
    "is_paid": {
        "type": "boolean",
        "description": "Whether the invoice has been paid"
    }
}
```

#### Array Fields

```python
{
    "line_items": {
        "type": "array",
        "items": {
            "type": "object",
            "properties": {
                "description": {"type": "string"},
                "quantity": {"type": "number"},
                "price": {"type": "number"}
            }
        }
    }
}
```

#### Nested Objects

```python
{
    "vendor": {
        "type": "object",
        "properties": {
            "name": {"type": "string"},
            "address": {"type": "string"},
            "phone": {"type": "string"}
        }
    }
}
```

## Input Options

### From File Path

```python
result = client.extract_and_wait(
    file="invoice.pdf",
    schema=schema
)
```

### From File Bytes

```python
with open("invoice.pdf", "rb") as f:
    file_bytes = f.read()

result = client.extract_and_wait(
    file=file_bytes,
    schema=schema
)
```

### From URL

```python
result = client.extract_and_wait(
    file_url="https://example.com/invoice.pdf",
    schema=schema
)
```

<Note>
  Use `file` for local files or bytes, `file_url` for remote URLs. Don't use both.
</Note>

## Extract Parameters

```python
result = client.extract_and_wait(
    file="document.pdf",
    schema=schema,
    confidence_threshold=0.9,  # Minimum confidence score (0.0-1.0)
    citation_config={          # Optional: citation configuration
        "mode": "xml",         # or "markdown"
        "include_page_numbers": True
    }
)
```

### Parameter Reference

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| `file` | `str \| Path \| bytes` | - | File path or bytes |
| `file_url` | `str` | - | URL of document |
| `schema` | `dict` | Required | JSON schema defining data to extract |
| `confidence_threshold` | `float` | `0.9` | Minimum confidence score (0.0-1.0) |
| `citation_config` | `dict` | `None` | Citation configuration |

## Response Structure

### ExtractResponse Object

```python
@dataclass
class ExtractResponse:
    job_id: str                    # Unique job identifier
    status: str                    # "completed", "failed", "processing"
    file_name: Optional[str]       # Original file name
    created_at: Optional[str]      # Job creation timestamp
    updated_at: Optional[str]      # Last update timestamp
    message: Optional[str]         # Status message
    result: Optional[Dict]         # Extracted data
    error: Optional[str]           # Error message if failed
    quota_remaining: Optional[int] # Remaining API quota
```

### Result Structure

Each extracted field includes value, confidence score, and optional citation:

```python
{
    "field_name": {
        "value": "extracted value",
        "score": 0.95,  # Confidence score (0.0-1.0)
        "citation": "optional citation text"
    }
}
```

## Real-World Examples

### Invoice Extraction

```python
schema = {
    "type": "object",
    "properties": {
        "invoice_number": {
            "type": "string",
            "description": "Invoice number or ID"
        },
        "invoice_date": {
            "type": "string",
            "description": "Date the invoice was issued"
        },
        "due_date": {
            "type": "string",
            "description": "Payment due date"
        },
        "vendor": {
            "type": "object",
            "properties": {
                "name": {"type": "string", "description": "Vendor company name"},
                "address": {"type": "string", "description": "Vendor address"},
                "phone": {"type": "string", "description": "Vendor phone number"}
            }
        },
        "customer": {
            "type": "object",
            "properties": {
                "name": {"type": "string", "description": "Customer name"},
                "address": {"type": "string", "description": "Customer address"}
            }
        },
        "line_items": {
            "type": "array",
            "description": "List of items or services",
            "items": {
                "type": "object",
                "properties": {
                    "description": {"type": "string"},
                    "quantity": {"type": "number"},
                    "unit_price": {"type": "number"},
                    "total": {"type": "number"}
                }
            }
        },
        "subtotal": {"type": "number", "description": "Subtotal amount"},
        "tax": {"type": "number", "description": "Tax amount"},
        "total": {"type": "number", "description": "Total amount due"}
    },
    "required": ["invoice_number", "total"],
    "additionalProperties": False
}

result = client.extract_and_wait(file="invoice.pdf", schema=schema)

print(f"Invoice #{result.result['invoice_number']['value']}")
print(f"Total: ${result.result['total']['value']}")
print(f"Vendor: {result.result['vendor']['value']['name']}")
```

### Contract Extraction

```python
schema = {
    "type": "object",
    "properties": {
        "contract_title": {
            "type": "string",
            "description": "Title of the contract"
        },
        "parties": {
            "type": "array",
            "description": "Parties involved in the contract",
            "items": {
                "type": "object",
                "properties": {
                    "name": {"type": "string"},
                    "role": {"type": "string", "description": "e.g., Buyer, Seller"}
                }
            }
        },
        "effective_date": {
            "type": "string",
            "description": "When the contract becomes effective"
        },
        "expiration_date": {
            "type": "string",
            "description": "When the contract expires or ends"
        },
        "payment_terms": {
            "type": "string",
            "description": "Payment terms and conditions"
        },
        "termination_clause": {
            "type": "string",
            "description": "Conditions for contract termination"
        }
    },
    "required": ["contract_title", "parties"],
    "additionalProperties": False
}

result = client.extract_and_wait(file="contract.pdf", schema=schema)
```

### Resume/CV Extraction

```python
schema = {
    "type": "object",
    "properties": {
        "personal_info": {
            "type": "object",
            "properties": {
                "name": {"type": "string"},
                "email": {"type": "string"},
                "phone": {"type": "string"},
                "location": {"type": "string"}
            }
        },
        "summary": {
            "type": "string",
            "description": "Professional summary or objective"
        },
        "work_experience": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "company": {"type": "string"},
                    "position": {"type": "string"},
                    "start_date": {"type": "string"},
                    "end_date": {"type": "string"},
                    "responsibilities": {
                        "type": "array",
                        "items": {"type": "string"}
                    }
                }
            }
        },
        "education": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "institution": {"type": "string"},
                    "degree": {"type": "string"},
                    "field": {"type": "string"},
                    "graduation_date": {"type": "string"}
                }
            }
        },
        "skills": {
            "type": "array",
            "items": {"type": "string"}
        }
    },
    "required": ["personal_info"],
    "additionalProperties": False
}

result = client.extract_and_wait(file="resume.pdf", schema=schema)
```

### Financial Statement Extraction

```python
schema = {
    "type": "object",
    "properties": {
        "company_name": {"type": "string"},
        "fiscal_year": {"type": "string"},
        "revenue": {"type": "number", "description": "Total revenue"},
        "expenses": {"type": "number", "description": "Total expenses"},
        "net_income": {"type": "number", "description": "Net income or profit"},
        "assets": {
            "type": "object",
            "properties": {
                "current": {"type": "number"},
                "non_current": {"type": "number"},
                "total": {"type": "number"}
            }
        },
        "liabilities": {
            "type": "object",
            "properties": {
                "current": {"type": "number"},
                "non_current": {"type": "number"},
                "total": {"type": "number"}
            }
        }
    },
    "required": ["company_name", "fiscal_year"],
    "additionalProperties": False
}

result = client.extract_and_wait(file="financial_statement.pdf", schema=schema)
```

## Citations

Enable citations to get references to where data was found:

```python
result = client.extract_and_wait(
    file="document.pdf",
    schema=schema,
    citation_config={
        "mode": "xml",  # or "markdown"
        "include_page_numbers": True
    }
)

for field, data in result.result.items():
    print(f"{field}: {data['value']}")
    if 'citation' in data:
        print(f"  Citation: {data['citation']}")
```

## Batch Extraction

Process multiple documents with the same schema:

```python
import asyncio
from unsiloed_sdk import AsyncUnsiloedClient

async def extract_multiple():
    schema = {
        "type": "object",
        "properties": {
            "invoice_number": {"type": "string"},
            "total": {"type": "number"}
        },
        "required": ["invoice_number", "total"],
        "additionalProperties": False
    }

    async with AsyncUnsiloedClient(api_key="your-api-key") as client:
        files = ["invoice1.pdf", "invoice2.pdf", "invoice3.pdf"]

        tasks = [
            client.extract_and_wait(file=f, schema=schema)
            for f in files
        ]

        results = await asyncio.gather(*tasks)

        for file, result in zip(files, results):
            if result.status == "completed":
                data = result.result
                print(f"{file}: {data['invoice_number']['value']} - ${data['total']['value']}")

asyncio.run(extract_multiple())
```

## Working with Extracted Data

### Convert to DataFrame

```python
import pandas as pd

result = client.extract_and_wait(file="invoices.pdf", schema=schema)

# Extract values only
data = {
    field: info['value']
    for field, info in result.result.items()
}

df = pd.DataFrame([data])
print(df)
```

### Filter by Confidence

```python
def filter_by_confidence(result, min_confidence=0.8):
    filtered = {}
    for field, data in result.result.items():
        if data['score'] >= min_confidence:
            filtered[field] = data['value']
        else:
            print(f"Warning: {field} has low confidence ({data['score']:.2%})")
    return filtered

result = client.extract_and_wait(file="document.pdf", schema=schema)
high_confidence_data = filter_by_confidence(result, min_confidence=0.9)
```

### Save to JSON

```python
import json

result = client.extract_and_wait(file="document.pdf", schema=schema)

# Save with confidence scores
with open("extracted_data.json", "w") as f:
    json.dump(result.result, f, indent=2)

# Save values only
values_only = {k: v['value'] for k, v in result.result.items()}
with open("extracted_values.json", "w") as f:
    json.dump(values_only, f, indent=2)
```

## Error Handling

```python
from unsiloed_sdk import (
    UnsiloedClient,
    InvalidRequestError,
    APIError
)

try:
    result = client.extract_and_wait(
        file="document.pdf",
        schema=schema
    )

    if result.status == "completed":
        print("Extraction successful!")
    elif result.status == "failed":
        print(f"Extraction failed: {result.error}")
    elif result.status == "review":
        print("Manual review required")

except InvalidRequestError as e:
    print(f"Invalid schema or parameters: {e.message}")
except APIError as e:
    print(f"API error: {e.message}")
```

## Best Practices

<Steps>
  <Step title="Write Clear Descriptions">
    Use detailed descriptions in your schema to guide extraction
  </Step>

  <Step title="Start Simple">
    Begin with a minimal schema and add fields incrementally
  </Step>

  <Step title="Mark Required Fields">
    Use the `required` array to specify mandatory fields
  </Step>

  <Step title="Check Confidence Scores">
    Always review confidence scores, especially for critical data
  </Step>

  <Step title="Use Citations for Verification">
    Enable citations to verify extracted data
  </Step>

  <Step title="Handle Missing Data">
    Not all fields may be present; check for None values
  </Step>

  <Step title="Batch Similar Documents">
    Use async processing for multiple documents with same schema
  </Step>
</Steps>

## Next Steps

<CardGroup cols={2}>
  <Card title="Classification" icon="tags" href="/sdks/python/classification">
    Classify documents into categories
  </Card>
  <Card title="Splitting" icon="scissors" href="/sdks/python/splitting">
    Split documents by page categories
  </Card>
</CardGroup>
